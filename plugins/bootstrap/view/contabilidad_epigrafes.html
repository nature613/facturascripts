{include="header"}

<!-- 
 NO TIENE BOTON NUEVO GRUPO EN EL BTN-TOOLBAR
 NO TIENE BOTON NUEVO EPIGRAFE EN EL BTN-TOOLBAR
 MO TIENE BOTON NUEVA CUETNA EN EL BTN-TOOLBAR
-->

<script type="text/javascript">
   $(document).ready(function() {
      $("#b_nuevo_grupo, #b_nuevo_grupo2").click(function(event) {
         event.preventDefault();
         fs_show_popup('popup_nuevo_grupo');
         document.f_nuevo_grupo.ngrupo.select();
      });
      $("#b_nuevo_epigrafe, #b_nuevo_epigrafe2").click(function(event) {
         event.preventDefault();
         fs_show_popup('popup_nuevo_epigrafe');
         document.f_nuevo_epigrafe.nepigrafe.select();
      });
      $("#b_nueva_cuenta, #b_nueva_cuenta2").click(function(event) {
         event.preventDefault();
         fs_show_popup('popup_nueva_cuenta');
         document.f_nueva_cuenta.ncuenta.select();
      });
      {if condition="$fsc->grupo"}
      $("#b_eliminar").click(function(event) {
         event.preventDefault();
         if( confirm("¿Realmente desea eliminar este grupo?") )
            window.location.href = '{$fsc->page->url()}&deleteg={$fsc->grupo->idgrupo}';
      });
      {/if}
      {if condition="$fsc->epigrafe"}
      $("#b_eliminar").click(function(event) {
         event.preventDefault();
         if( confirm("¿Realmente desea eliminar este epígrafe?") )
            window.location.href = '{$fsc->page->url()}&deletee={$fsc->epigrafe->idepigrafe}';
      });
      {/if}
   });
</script>

{if condition="$fsc->grupo"}
<div class="popup" id="popup_nuevo_epigrafe">
   <h3>Nuevo epígrafe</h3>
   <form class="form-horizontal" class="form" role="form" name="f_nuevo_epigrafe" action ="{$fsc->url()}" method="POST">
      <div class="form-group">
         <label for="scodpais" class="col-sm-2 control-label">Grupo</label>
         <div class="col-sm-10">
            {$fsc->grupo->codgrupo}
            <input class="form-control" type="hidden" name="ejercicio" value="{$fsc->grupo->codejercicio}"/>
            <input class="form-control" type="hidden" name="idgrupo" value="{$fsc->grupo->idgrupo}"/>
            <input class="form-control" type="hidden" name="codgrupo" value="{$fsc->grupo->codgrupo}"/>
          </div>
      </div>
      <div class="form-group">
         <label for="nepigrafe" class="col-sm-2 control-label">Código</label>
         <div class="col-sm-10">
         <input class="form-control" type="text" name="nepigrafe" value="{$fsc->grupo->codgrupo}0" autocomplete="off"/>
          </div>
      </div>
      <div class="form-group">
         <label for="descripcion" class="col-sm-2 control-label">Descripción</label>
         <div class="col-sm-10">
         <input class="full form-control" type="text" name="descripcion" autocomplete="off"/>
          </div>
      </div>
      <div class="form-group">
        <div class="col-sm-offset-2 col-sm-10 text-right">
            <button class="btn btn-sm btn-primary pull-right" type="submit" value="Guardar" onclick="this.disabled=true;this.form.submit();" title="Guardar">
               <span class="glyphicon glyphicon-floppy-disk"></span>
               &nbsp; Guardar
            </button>
          </div>
      </div>
   </form>
</div>

<div class="well well-sm">
   <div class="table-responsive">
      <table class="table table-hover">
         <tr>
            <th align="left">Descripción</th>
            <th align="right">Ejercicio</th>
         </tr>
         <tr>
            <td>
               <form action="{$fsc->grupo->url()}" method="post">
                  <input class="form-control" type="text" name="descripcion" value="{$fsc->grupo->descripcion}" autocomplete="off"/>
               </form>
            </td>
            <td align="right">
               <a class="link" href="index.php?page=contabilidad_ejercicio&cod={$fsc->grupo->codejercicio}">{$fsc->grupo->codejercicio}</a>
            </td>
         </tr>
      </table>
      <button class="btn btn-sm btn-primary pull-right" type="submit" value="Guardar" onclick="this.disabled=true;this.form.submit();" title="Guardar">
         <span class="glyphicon glyphicon-floppy-disk"></span>
         &nbsp; Guardar
      </button>
      <br/><br/>
</div>
<div class="well well-sm">
   <div class="table-responsive">
      <table class="table table-hover">
         <tr>
            <th align="left">Código</th>
            <th align="left">Descripción</th>
         </tr>
         {loop="$fsc->resultados"}
         <tr>
            <td><a class="link" href="{$value->url()}">{$value->codepigrafe}</a></td>
            <td><a class="link" href="{$value->url()}">{$value->descripcion}</a></td>
         </tr>
         {/loop}
         <tr>
            <td colspan="2">
               <div class="new_line">
                  <a id="b_nuevo_epigrafe2" href="#">Nuevo epígrafe</a>
               </div>
            </td>
         </tr>
      </table>
   </div>
</div>
{elseif condition="$fsc->epigrafe"}
<div class="popup" id="popup_nueva_cuenta">
   <h3>Nueva cuenta</h3>
   <form class="form-horizontal" class="form" role="form" name="f_nueva_cuenta" action ="{$fsc->url()}" method="POST">
      <div class="form-group">
         <label for="scodpais" class="col-sm-2 control-label">Epígrafe</label>
         <div class="col-sm-10">
               <input class="form-control" type="hidden" name="ejercicio" value="{$fsc->epigrafe->codejercicio}"/>
               <input class="form-control" type="hidden" name="idepigrafe" value="{$fsc->epigrafe->idepigrafe}"/>
               <input class="form-control" type="hidden" name="codepigrafe" value="{$fsc->epigrafe->codepigrafe}"/>
               {$fsc->epigrafe->codepigrafe}
          </div>
      </div>
      <div class="form-group">
         <label for="ncuenta" class="col-sm-2 control-label">Código</label>
         <div class="col-sm-10">
         <input class="full form-control" type="text" name="ncuenta" value="{$fsc->epigrafe->codepigrafe}0" autocomplete="off"/>
          </div>
      </div>
      <div class="form-group">
         <label for="descripcion" class="col-sm-2 control-label">Descripción</label>
         <div class="col-sm-10">
         <input class="full form-control" type="text" name="descripcion" autocomplete="off"/>
          </div>
      </div>
      <div class="form-group">
        <div class="col-sm-offset-2 col-sm-10 text-right">
            <button class="btn btn-sm btn-primary pull-right" type="submit" value="Guardar" onclick="this.disabled=true;this.form.submit();" title="Guardar">
               <span class="glyphicon glyphicon-floppy-disk"></span>
               &nbsp; Guardar
            </button>
          </div>
      </div>
   </form>
</div>

<div class="well well-sm">
   <div class="table-responsive">
      <table class="table table-hover">
         <tr>
            <th align="left">Descripción</th>
            <th align="right">Ejercicio</th>
         </tr>
         <tr>
            <td>
               <form action="{$fsc->epigrafe->url()}" method="post">
                  <input class="form-control" type="text" name="descripcion" value="{$fsc->epigrafe->descripcion}" autocomplete="off"/>
               </form>
            </td>
            <td align="right">
               <a class="link" href="index.php?page=contabilidad_ejercicio&cod={$fsc->epigrafe->codejercicio}">{$fsc->epigrafe->codejercicio}</a>
            </td>
         </tr>
      </table>
      <button class="btn btn-sm btn-primary pull-right" type="submit" value="Guardar" onclick="this.disabled=true;this.form.submit();" title="Guardar">
         <span class="glyphicon glyphicon-floppy-disk"></span>
         &nbsp; Guardar
      </button>
      <br/><br/>
   </div>
</div>
<div class="well well-sm">
   <div class="table-responsive">
      <table class="table table-hover">
         <tr>
            <th align="left">Código + Descripción</th>
            <th align="right">Cuenta especial</th>
         </tr>
         {loop="$fsc->resultados"}
         <tr>
            <td><a class="link" href="{$value->url()}">{$value->codcuenta}</a> {$value->descripcion}</td>
            <td align="right">{$value->idcuentaesp}</td>
         </tr>
         {/loop}
         <tr>
            <td colspan="2">
               <div class="new_line">
                  <a id="b_nueva_cuenta2" href="#">Nueva cuenta</a>
               </div>
            </td>
         </tr>
      </table>
   </div>
</div>
{else}
<div class="popup" id="popup_nuevo_grupo">
   <h3>Nuevo grupo</h3>
   <form class="form-horizontal" class="form" role="form" name="f_nuevo_grupo" action ="{$fsc->url()}" method="POST">
      <div class="form-group">
         <label for="scodpais" class="col-sm-2 control-label">Ejercicio</label>
         <div class="col-sm-10">
            <select name="ejercicio" class="form-control">
            {loop="$fsc->ejercicio->all()"}
               {if condition="$value->codejercicio==$fsc->codejercicio"}
               <option value="{$value->codejercicio}" selected="selected">{$value->nombre} ({$value->codejercicio})</option>
               {else}
               <option value="{$value->codejercicio}">{$value->nombre} ({$value->codejercicio})</option>
               {/if}
            {/loop}
            </select>
          </div>
      </div>
      <div class="form-group">
         <label for="snombre" class="col-sm-2 control-label">Código</label>
         <div class="col-sm-10">
         <input class="form-control" type="text" name="ngrupo" autocomplete="off"/>
          </div>
      </div>
      <div class="form-group">
         <label for="snombre" class="col-sm-2 control-label">Descripción</label>
         <div class="col-sm-10">
         <input class="full form-control" type="text" name="descripcion" autocomplete="off"/>
          </div>
      </div>
      <div class="form-group">
        <div class="col-sm-offset-2 col-sm-10 text-right">
            <button class="btn btn-sm btn-primary pull-right" type="submit" value="Guardar" onclick="this.disabled=true;this.form.submit();" title="Guardar">
               <span class="glyphicon glyphicon-floppy-disk"></span>
               &nbsp; Guardar
            </button>
          </div>
      </div>
   </form>
</div>
<div class="well well-sm">
   <div class="table-responsive">
      <table class="table table-hover">
         <tr>
            <td>
               <form name="f_filtro_cuentas" action="{$fsc->url()}" method="post">
                  <b>Ejercicio:</b>
                  <select name="ejercicio" class="form-control" onchange="document.f_filtro_cuentas.submit()">
                     {loop="$fsc->ejercicio->all()"}
                        {if condition="$value->codejercicio==$fsc->codejercicio"}
                        <option value="{$value->codejercicio}" selected="selected">{$value->nombre} ({$value->codejercicio})</option>
                        {else}
                        <option value="{$value->codejercicio}">{$value->nombre} ({$value->codejercicio})</option>
                        {/if}
                     {/loop}
                  </select>
               </form>
            </td>
            <td align="right">
               <a class="btn btn-sm btn-default" href="index.php?page=contabilidad_cuentas">Cuentas &gt;</a>
            </td>
         </tr>
      </table>
      <br/>
      <table class="table table-hover">
         <tr>
            <th align="left">Código</th>
            <th align="left">Descripción</th>
         </tr>
         {loop="$fsc->resultados"}
         <tr>
            <td><a class="link" href="{$value->url()}">{$value->codgrupo}</a></td>
            <td><a class="link" href="{$value->url()}">{$value->descripcion}</a></td>
         </tr>
         {/loop}
         <tr>
            <td colspan="2">
               <div class="new_line">
                  <a id="b_nuevo_grupo2" href="#">Nuevo grupo</a>
               </div>
            </td>
         </tr>
      </table>
   </div>
</div>
{/if}

{include="footer"}
