{include="header"}

<script type="text/javascript">
   $(document).ready(function() {
      $("#b_nueva").click(function() {
         $("#modal_nueva").modal('show');
      });
      $("#b_huecos").click(function() {
         $("#modal_huecos").modal('show');
      });
   });
</script>

<div class="modal fade" id="modal_nueva">
   <div class="modal-dialog">
      <div class="modal-content">
         <div class="modal-header">
            <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
            <h4 class="modal-title">Nueva factura</h4>
         </div>
         <div class="modal-body">
            En lugar de crear una factura directamente, es mejor que crees un {$albaran} de cliente (que es un "borrador" de factura) y después pulses el botón <b>generar factura</b>.
            <br/><br/>
            Trabajar con {$albaranes} es más cómodo porque puedes modificarlos e incluso agruparlos en una sola factura.
         </div>
         <div class="modal-footer">
            <button class="btn btn-sm btn-primary pull-right" href="index.php?page=general_nuevo_albaran" title="Crear un {$albaran}">
               <span class="glyphicon glyphicon-plus"></span>
               &nbsp; Crear un {$albaran}
            </button>
         </div>
      </div>
   </div>
</div>

<div class="modal fade" id="modal_huecos">
   <div class="modal-dialog">
      <div class="modal-content">
         <div class="modal-header">
            <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
            <h4 class="modal-title">Huecos</h4>
         </div>
         <div class="modal-body">
            <div class="table-responsive">
               <table class="table table-hover">
                  <tr>
                     <th>Código</th>
                     <th>Fecha</th>
                  </tr>
                  {loop="$fsc->factura->huecos()"}
                  <tr>
                     <td align="center">{$value.codigo}</td>
                     <td align="center">{$value.fecha}</td>
                  </tr>
                  {else}
                  <tr><td colspan="2" align="center">No hay huecos</td></tr>
                  {/loop}
               </table>
            </div>
         </div>
      </div>
   </div>
</div>

{if condition="$fsc->query!=''"}
<h1>Resultados de "{$fsc->query}":</h1>
{/if}

<div class="table-responsive">
   <table class="table table-hover">
      <thead>
         <tr>
            <th></th>
            <th align="left">Código + Cliente</th>
            <th align="left">Observaciones</th>
            <th align="right">Total</th>
            <th align="right">Fecha</th>
         </tr>
      </thead>
      {loop="$fsc->resultados"}
      <tr>
         <td align="center">
            {if condition="$value->idasiento"}
            <span class="glyphicon glyphicon-paperclip" title="La factura tiene vinculado un asiento contable"></span>
            {/if}
         </td>
         <td><a href="{$value->url()}">{$value->codigo}</a> {$value->nombrecliente}</td>
         <td>{$value->observaciones_resume()}</td>
         <td align="right">{$fsc->show_precio($value->total, $value->coddivisa)}</td>
         <td align="right">{$value->fecha}</td>
      </tr>
      {else}
      <tr><td colspan="5" align="center">Ninguna factura encontrada</td></tr>
      {/loop}
   </table>
</div>

<ul class="pager" id="ul_paginador">
   <li class="previous{if condition="$fsc->anterior_url()==''"} disabled{/if}"><a href="{$fsc->anterior_url()}">&larr; anteriores</a></li>
   <li class="next{if condition="$fsc->siguiente_url()==''"} disabled{/if}"><a href="{$fsc->siguiente_url()}">siguientes &rarr;</a></li>
</ul>

{include="footer"}
