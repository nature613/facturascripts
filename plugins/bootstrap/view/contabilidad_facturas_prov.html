{include="header"}

<script type="text/javascript">
   $(document).ready(function() {
      document.f_custom_search.query.focus();
      $("#b_nueva").click(function() {
         fs_show_popup('popup_nueva', 50);
      });
   });
</script>

<div class="popup" id="popup_nueva">
   <h3>Nueva factura</h3>
   <form class="form-horizontal" class="form" role="form" name="f_nuevo_pais" action ="{$fsc->url()}" method="POST">
      <div class="form-group">
         <div class="col-sm-10">
            En lugar de crear una factura directamente, es mejor que crees un {$albaran} de cliente (que es un "borrador" de factura)
            y después pulses el botón <b>generar factura</b>.
            <br/><br/>
            Trabajar con {$albaranes} es más cómodo porque puedes modificarlos e incluso agruparlos en una sola factura.
         </div>
      </div>
      <div class="form-group">
        <div class="col-sm-offset-2 col-sm-10 text-right">
            <button class="btn btn-sm btn-primary pull-right" href="index.php?page=general_nuevo_albaran" value="Crear un {$albaran}" title="Crear un {$albaran}">
               <span class="glyphicon glyphicon-plus"></span>
               &nbsp; Crear un {$albaran}
            </button>
          </div>
      </div>
   </form>
</div>

{if condition="$fsc->query!=''"}
<h1>Resultados de "{$fsc->query}":</h1>
{/if}

<div class="table-responsive">
   <table class="table table-hover">
      <thead>
         <tr>
            <th></th>
            <th align="left">Código + Num. Proveedor</th>
            <th align="left">Proveedor</th>
            <th align="left">Observaciones</th>
            <th align="right">Total</th>
            <th align="right">Fecha</th>
         </tr>
      </thead>
      {loop="$fsc->resultados"}
      <tr>
         <td align="center">
            {if condition="$value->idasiento"}
            <span class="glyphicon glyphicon-paperclip" title="La factura tiene vinculado un asiento contable"></span>
            {/if}
         </td>
         <td><a href="{$value->url()}">{$value->codigo}</a> {$value->numproveedor}</td>
         <td>{$value->nombre}</td>
         <td>{$value->observaciones_resume()}</td>
         <td align="right">{$fsc->show_precio($value->total, $value->coddivisa)}</td>
         <td align="right">{$value->fecha}</td>
      </tr>
      {else}
      <tr><td colspan="6" align="center">Ninguna factura encontrada</td></tr>
      {/loop}
   </table>
</div>

<ul class="pager" id="ul_paginador">
   <li class="previous{if condition="$fsc->anterior_url()==''"} disabled{/if}"><a href="{$fsc->anterior_url()}">&larr; anteriores</a></li>
   <li class="next{if condition="$fsc->siguiente_url()==''"} disabled{/if}"><a href="{$fsc->siguiente_url()}">siguientes &rarr;</a></li>
</ul>

{include="footer"}